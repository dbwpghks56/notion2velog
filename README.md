# Notion2Velog

# ğŸ’± Notion 2 Velog

ì²˜ìŒ ì´ ë§¤í¬ë¡œë¥¼ ê°œë°œí•˜ê¸°ë¡œ ë§ˆìŒ ë¨¹ì€ ê²ƒì€ DX ìœ„í‚¤ì— ìë£Œë¥¼ ì˜¬ë¦¬ê³  ë³´ë‹ˆ velogì—ë„ ë”°ë¡œ ì˜¬ë ¤ì„œ ìë£Œë¥¼ ì •ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì„ ë•Œì…ë‹ˆë‹¤.

ë‘ ê°œì˜ ìœ„í‚¤ë¥¼ ì‘ì„±í•˜ê³  velogì— ì˜®ê¸°ë ¤ê³  í•˜ë‹ˆ ë¬¼ë¡  ë³µì‚¬ ë¶™ì—¬ë„£ê¸°ê°€ ëì´ì§€ë§Œ ê·¸ ê³¼ì • ì—­ì‹œ ê·€ì°®ê²Œ ëŠê»´ì¡ŒìŠµë‹ˆë‹¤. python ìœ¼ë¡œ ë§¤í¬ë¡œ ë° ì›¹ ìŠ¤í¬ë©ì´ ê°€ëŠ¥í•˜ë‹ˆ ë§Œë“¤ì–´ ë³¼ ìˆ˜ ìˆê² ë‹¤ ë¼ëŠ” ìƒê°ê³¼ í•¨ê»˜ ë°”ë¡œ ì‘ì—…ì„ ì‹œì‘ í–ˆìŠµë‹ˆë‹¤.

## ğŸ± í”„ë¡œì íŠ¸ ë§í¬

### - [ğŸ± Github](https://github.com/dbwpghks56/notion2velog)

## ğŸ¨ ì„¤ê³„

python ìœ¼ë¡œ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê±´ ì•Œì•˜ì§€ë§Œ python ì„ ì‚¬ìš©í•´ë³¸ ê±´ ì•Œê³ ë¦¬ì¦˜ í’€ ë•Œ ë¿ì´ë¼ êµ¬ê¸€ì„ ë§ì´ ì°¾ì•„ë´¤ìŠµë‹ˆë‹¤. ê·¸ì¤‘ì— ëˆˆì— ë“¤ì–´ì˜¨ ê²ƒì€ ì–´ë””ì„œ ë“¤ì–´ë³¸ ì ì´ ìˆëŠ” selenium ì…ë‹ˆë‹¤.

seleniumì„ ì´ìš©í•´ notionì„ ì—´ì–´ì„œ ë‚´ìš©ì„ ê¸ì–´ì˜¤ê³  ë‹¤ì‹œ velogë¥¼ ì—´ì–´ ë‚´ìš©ì„ ë¶™ì—¬ë„£ëŠ” ë°©ì‹ì„ ìƒê°í–ˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ seleniumì˜ ê²½ìš° ê°€ìƒì˜ ì›¹ì„ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— ë¡œê·¸ì¸ë¶€í„° ë‹¤ì‹œí•´ì•¼ëœë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ê³ ,

ë¡œì§ì˜ ìˆœì„œë¡œëŠ” 

- notion ë° velog ë¡œê·¸ì¸ì„ ì§„í–‰í•œë‹¤. ì´ ê³¼ì •ì—ì„œ ì™„ë£Œì‹œ *.pkl ì´ë¼ëŠ” íŒŒì¼ì´ ìƒì„± ë˜ëŠ”ë° ì´ íŒŒì¼ì—ëŠ” ë¡œê·¸ì¸ ì„±ê³µ ì§í›„ì˜ cookie ê°’ì´ ë“¤ì–´ìˆê¸° ë•Œë¬¸ì— í† í° ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
( ë•Œë¬¸ì— .exe íŒŒì¼ê³¼ *.pkl íŒŒì¼ì€ ê°™ì€ ê²½ë¡œ(í´ë”) ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.)
- í›„ì—ëŠ” GUIì— ë‚˜ì˜¨ë°ë¡œ notin url ì…ë ¥ í›„ ë²„íŠ¼ í´ë¦­ì‹œ notion ë°ì´í„° ë³µì œê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
- ì™„ë£Œê°€ ë˜ë©´ .exe í”„ë¡œê·¸ë¨ì—ì„œ ë¡œê·¸ì¸í•œ ê³„ì •ì˜ velogì— ì ‘ì†í•´ ì„ì‹œì €ì¥ íƒ­ì„ í™•ì¸í•˜ë©´ ë©ë‹ˆë‹¤.

## ğŸŒ¿ Selenium

seleniumì„ ì´ìš©í•´ ì…ë ¥ëœ notion url ì— ì ‘ì†í•´ ë³¸ë¬¸ì˜ divì— ì ‘ê·¼í•˜ê³  í•´ë‹¹ div ë¥¼ ì „ì²´ ë³µì‚¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.  ê·¸ ì „ì— title ê°’ì„ ì½ì–´ì™€ ë”°ë¡œ ë³€ìˆ˜ì— ì €ì¥í•´ì¤ë‹ˆë‹¤.

ë³¸ë¬¸ì˜ ë‚´ìš©ì„ ê¸ì–´ì™€ì„œ ì§„í–‰í•˜ë ¤ í–ˆì§€ë§Œ ê·¸ëŸ´ ê²½ìš° markdownì˜ ë¬¸ë²•ì´ ì ìš©ë˜ì§€ ì•Šì•„. ë§ì€ ì–´ë ¤ì›€ì´ ìˆì—ˆìŠµë‹ˆë‹¤. 

í•˜ì—¬ ë³¸ë¬¸ì„ ë³µì‚¬í•œë’¤

[velog.io/write](http://velog.io/write) ì— ì ‘ì†í•˜ì—¬ title ë³€ìˆ˜ì˜ ë‚´ìš©ì„ ì œëª©ìœ¼ë¡œ ì…ë ¥í•˜ê³ ,

selenium ì˜ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë³¸ë¬¸ì˜ div ë¥¼ click() í›„ì— actions ì˜ chainì„ ì´ˆê¸°í™”í•´ì£¼ê³  ë¶™ì—¬ë„£ê¸° ì‘ì—…ì„ ì§„í–‰í•´ì¤ë‹ˆë‹¤. 

ê·¸ ë’¤ seleniumì„ ì´ìš©í•´ ê°€ì ¸ì˜¨ ì„ì‹œì €ì¥ ë²„íŠ¼ì„ click() ì„ ì´ìš©í•´ ëˆŒëŸ¬ì¤€ ë’¤ ì°½ì„ ë‹«ìŠµë‹ˆë‹¤.

seleniumì˜ ì›¹ ìŠ¤í¬ë©í•‘ ëŠ¥ë ¥ì´ ë§¤ìš° ê°•ë ¥í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œëœ ì‘ì—…ì´ì—ˆìŠµë‹ˆë‹¤.

ì´ê²Œ ê°€ëŠ¥í•œê°€ í•˜ê³  ìƒìƒìœ¼ë¡œ ìƒê°í•œ ê¸°ëŠ¥ì´ ëŒ€ë¶€ë¶„ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì´ ë†€ë¼ì› ìŠµë‹ˆë‹¤. 

## ğŸš§ í•œê³„ì 

- ~~seleniumì„ ì´ìš©í•´ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ê¸°í•˜ëŠ” ê°„ë‹¨í•œ ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì— ì´ë¯¸ì§€ê¹Œì§€ ê°€ëŠ¥í•˜ì§€ëŠ” ì•Šì•„ ë³´ì…ë‹ˆë‹¤.

ë¬¼ë¡  ì´ë¯¸ì§€ url ì„ ì œëŒ€ë¡œ ê°€ì ¸ì˜¤ì§€ë§Œ notionì˜ ë³´ì•ˆ ì •ì±…ì¸ì§€ notionì˜ s3 ì— ì œëŒ€ë¡œ ì ‘ê·¼ì„ ëª»í•˜ì—¬ ì´ë¯¸ì§€ê°€ ì•ˆ ë‚˜ì˜¨ë‹¤ê³  ìƒê°ë©ë‹ˆë‹¤.~~
- ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ì§€ë§Œ ì •í™•í•œ ìœ„ì¹˜ì— ì‚½ì…ì€ ì–´ë µìŠµë‹ˆë‹¤. ë¬¼ë¡  ê³ ì¹˜ë ¤ ë…¸ë ¥ì€ í•´ë³´ê² ìŠµë‹ˆë‹¤.
- Velogì˜ ê²½ìš°ì—ëŠ” git ë§Œ notion ì˜ ê²½ìš°ì—ëŠ” ì§ì ‘ ì´ë©”ì¼ì„ ì…ë ¥í•œ ê²½ìš°ì—ë§Œ ë¡œê·¸ì¸ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. seleniumì˜ í•œê³„ì ìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤ë§Œ ìë£Œë¥¼ ë” ì°¾ì•„ë³´ì•„ì•¼ê² ìŠµë‹ˆë‹¤.

## ğŸ‘©ğŸ»â€ğŸ’» Code

```python
notionCookies = None
velogCookies = None
options = webdriver.ChromeOptions()
options.add_experimental_option('excludeSwitches', ['enable-logging'])
options.add_experimental_option("excludeSwitches", ["enable-automation"])
options.add_experimental_option("useAutomationExtension", False)
service = Service(executable_path=ChromeDriverManager().install())
file_paths = []
notionMainLink = "https://www.notion.so/"

def notion():
    global file_paths
    if entryNotionURL.get() != "" and notionMainLink in entryNotionURL.get():
        urlCautionContent.set("")
        driver = webdriver.Chrome(service=service, options=options)
        
        file = "notion.pkl"
        fileVelog = "velogGitLogin.pkl"
        
        if os.path.exists(file):
            notionCookies = pickle.load(open(file, "rb"))
            driver.get(notionMainLink)
            driver.delete_all_cookies()
            
            for cookie in notionCookies:
                # cookie.pop("domain")
                driver.add_cookie(cookie)
        # https://www.notion.so/ryudomain/c4828705de9e41e2b35bae5691cb7a81?pvs=4 
        # https://www.notion.so/mirimdxlab/Sentry-73f05aa15fdb454a9290f4b5fc6e6f47?pvs=4
        driver.get(entryNotionURL.get())
        
        driver.implicitly_wait(120)
        
        if velogTitleEntry.get() == "":
            title = driver.find_element(By.CSS_SELECTOR, '[placeholder="ì œëª© ì—†ìŒ"]').text
        
        else:
            title = velogTitleEntry.get()
        
        contents = driver.find_elements(By.CLASS_NAME, 'notion-page-content')

        for c in contents:
            for c2 in c.find_elements(By.CLASS_NAME, "notion-selectable"):
                c2.send_keys(Keys.CONTROL + 'a')
                c2.send_keys(Keys.CONTROL + 'c')
                
        for c in contents:
            for c2 in c.find_elements(By.TAG_NAME, "img"):
                if "notion.so" in c2.get_attribute("src"):
                    file_paths.append(c2.get_attribute("src"))
        
        driver.close()
        
        driver = webdriver.Chrome(service=service, options=options)

        if os.path.exists(fileVelog):
            velogCookies = pickle.load(open(fileVelog, "rb"))
            driver.get("https://velog.io")
            driver.delete_all_cookies()
            
            for cookie in velogCookies:
                driver.add_cookie(cookie)
        
        driver.get("https://velog.io/write")
        
        driver.implicitly_wait(120)
        
        velogTitle = driver.find_element(By.CSS_SELECTOR, '[placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"]')
        velogTitle.send_keys(title)
        
        velogTag = driver.find_element(By.CSS_SELECTOR, '[placeholder="íƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"]')
        velogTag.send_keys("Notion2Velog")
        velogTag.send_keys(Keys.ENTER)
        
        velogContent = driver.find_elements(By.CLASS_NAME, "CodeMirror")

        for v in velogContent:
            v.click()
            actions = ActionChains(driver)
            actions.key_down(Keys.CONTROL).send_keys('v').key_up(Keys.CONTROL)
            actions.key_down(Keys.ENTER).key_up(Keys.ENTER)
            actions.perform()
            
        for f in file_paths:
            driver2 = webdriver.Chrome(service=service, options=options)
            if os.path.exists(file):
                notionCookies = pickle.load(open(file, "rb"))
                driver2.get(notionMainLink)
                driver2.delete_all_cookies()
                
                for cookie in notionCookies:
                    # cookie.pop("domain")
                    driver2.add_cookie(cookie)
            
            driver2.get(f)
            c = driver2.find_element(By.TAG_NAME, "body")
            c.send_keys(Keys.CONTROL + 'c')
            actions.click()
            actions.perform()
            actions.key_down(Keys.CONTROL).send_keys('v').key_up(Keys.CONTROL)
            actions.perform()
            
            driver2.close()
            
        
        velogContent2 = driver.find_element(By.CLASS_NAME, "CodeMirror")
        wait = WebDriverWait(driver, 10)  # ìµœëŒ€ 10ì´ˆ ë™ì•ˆ ê¸°ë‹¤ë¦¼ (í•„ìš”ì— ë”°ë¼ ì¡°ì ˆ)
        def check_url(driver):
            return "ì—…ë¡œë“œì¤‘.." not in velogContent2.text
        # ì¡°ê±´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë‹¤ë¦¬ê¸°
        wait.until(check_url)
        
        testSave = driver.find_elements(By.CLASS_NAME, "icODNG")
        for btn in testSave:
            btn.click()
            
        time.sleep(0.5)
        
        driver.close()
        driver.quit()
        driver2.quit()
        file_paths = []
        successCheck.set(" ì„ì‹œì €ì¥ ì„±ê³µí–ˆìŠµë‹ˆë‹¤.")
        
    elif entryNotionURL.get() == "" or "https://www.notion.so/" not in entryNotionURL.get():
        successCheck.set("")
        urlCautionContent.set("notion url ì„ ì…ë ¥í•˜ì„¸ìš”.")
    # pyperclip.copy(content2)
    

def velogGitHubLogin():
    driver = webdriver.Chrome(service=service, options=options)
    try:
        driver.get("https://v2.velog.io/api/v2/auth/social/redirect/github?next=/&isIntegrate=0")
        
        # ë¡œê·¸ì¸ í›„ ë¦¬ë””ë ‰íŠ¸ë  ì˜ˆìƒ URL
        redirected_url = "https://velog.io/"
        wait = WebDriverWait(driver, 120)
        
        # ë¦¬ë””ë ‰íŠ¸ë˜ëŠ” ë™ì•ˆ ê¸°ë‹¤ë¦¬ê¸°
        wait.until(EC.url_to_be(redirected_url))
        
        if driver.current_url == redirected_url:
            pickle.dump(driver.get_cookies(), open("velogGitLogin.pkl", "wb"))
            checkVelogLogin.set("True")

    finally:
        # ì‘ì—… ì™„ë£Œ í›„ ë“œë¼ì´ë²„ ì¢…ë£Œ
        driver.quit()
    
def notionLogin():
    print(entryNotionURL.get() == "")
    driver = webdriver.Chrome(service=service, options=options)
    notionLoginUrl = "https://www.notion.so/login"
    try:
        driver.get(notionLoginUrl)
        
        # ë¡œê·¸ì¸ í›„ ë¦¬ë””ë ‰íŠ¸ë  ì˜ˆìƒ URL
        redirected_url = "https://www.notion.so/"
        wait = WebDriverWait(driver, 120)
        def check_url(driver):
            return redirected_url in driver.current_url and notionLoginUrl not in driver.current_url
        
        # ì¡°ê±´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë‹¤ë¦¬ê¸°
        wait.until(check_url)
        
        if redirected_url in driver.current_url and driver.current_url != notionLoginUrl :
            pickle.dump(driver.get_cookies(), open("notion.pkl", "wb"))
            checkNotionLogin.set("True")
            
    finally:
        # ì‘ì—… ì™„ë£Œ í›„ ë“œë¼ì´ë²„ ì¢…ë£Œ
        driver.quit()
```

## ğŸ–Šï¸ To Do

- ëª…í™•í•œ í•œê³„ì ì´ ìˆìœ¼ë‹ˆ ê°œì„ í•´ ë‚˜ê°ˆ ìƒê°ì…ë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” ë¬¼ë¡  ë¡œê·¸ì¸ ê¸°ëŠ¥ì˜ í•œê³„ì ê¹Œì§€ ê°œì„ í•´ë³¼ ìƒê°ì…ë‹ˆë‹¤.
- ì§€ê¸ˆ ìƒê°í•˜ëŠ” ì¶”ê°€ ê¸°ëŠ¥ì€
    - ~~ì œëª© ì…ë ¥ë°›ì•„ velog ì„ì‹œì €ì¥ ë•Œ ì‚¬ìš©í•˜ê¸° ( ë¹ˆ ë¬¸ìì—´ì˜ ê²½ìš° notionì˜ ë°ì´í„° ì‚¬ìš©)~~
    - ë¸Œë¼ìš°ì € ì‹¤ì œë¡œ ë„ìš°ì§€ ì•Šê³  ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë²• ì•Œì•„ë³´ê³ ( chrome add argument ì‹¤íŒ¨ )
    - ì†ë„ ê°œì„ 
    - ê¹ƒ readme ì—ë„ ì˜®ê¸°ê¸°..?
    - etcâ€¦

ê°€ ìˆìŠµë‹ˆë‹¤.

## ğŸ–¼ï¸ ê²°ê³¼
![image](https://github.com/dbwpghks56/notion2velog/assets/43091440/a0e34afd-67c2-46fd-8565-1a3c77cb03cd)
